\documentclass[onecolumn]{aastex63}

\usepackage[utf8]{inputenc}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{xspace}
\usepackage{hyperref}
\usepackage[T1]{fontenc}
\usepackage{lipsum}
\usepackage{comment}
\usepackage{xcolor}
\usepackage{multirow}
\usepackage{IEEEtrantools}
\usepackage{amsmath}
\usepackage{tabularx}
\usepackage{array}
\usepackage{enumitem}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\fsize}{13}
\newcommand{\fsizeb}{13}

\begin{document}

\LARGE
\begin{center}
\centering{KPF Community Cadence Supplemental Coversheet}
\end{center}
\hfill \\
Semester ID:
\hfill \\
Total Time Required to Complete Program (hr):
\hfill \\

\underline{Overview} \\
\normalsize

\par The KPF-CC program is a formalized queue observation system within the classically scheduled Keck Observatory. PI's who opt into the queue pool their awarded nights/quarters together for the community's use. On a give night assigned to a given PI, some or none of the night will be used to actually observe that PI's targets. Instead, the targets observed on a given night are those that the KPF-CC auto-scheduler algorithm determines should be observed that night. Questions about this document and/or about the KPF-CC program should be directed to the KPF-CC Project Scientist: Jack Lubin (jblubin@astro.ucla.edu). Any questions about interpreting a specific request should be asked in an anonymized way. \\

\LARGE
\underline{Parameters to Describe Observational Strategy} \\
\normalsize
\par The algorithm takes in the observational requests from all PI's and computes an optimal schedule of when to observe which stars throughout the semester. A PI describes their observational strategy in a way that the algorithm understands through 5 parameters:

\begin{itemize}
    \item \# of unique nights in the semester to observe the target
    \item the minimum time, in days, that must pass between unique night observations (inter-night cadence)
    \item \# of visits within each of those unique nights to observe the target
    \item if multiple visits are specified, the minimum time, in hours, that must pass between visits (intra-night cadence)
    \item \# of exposures to obtain at each visit
\end{itemize}

\noindent The observational strategy for each target is described in the table below according to the above definitions. When a request requires only 1 visit per night, by default the value for intra-night cadence is NaN. When a request requires only 1 unique night per semester, by default the value for inter-night cadence is NaN. \\

\LARGE
\underline{Time Accounting} \\
\normalsize
\par With these parameters, as well as the desired exposure time, KPF-CC computes a total amount of time required to complete the request, including overhead time charges. The calculation of total time required for a given target is as follows:

\begin{equation}
    E = N_e \times N_v \times N_u \times T
\label{eq:openshutter}
\end{equation}

\begin{equation}
    O = \big(45*(N_e - 1) + 200*N_v\big) \times N_u
\label{eq:overhead}
\end{equation}

\begin{equation}
    \mathrm{Total \, \, Time} = \frac{1}{3600} \times (E + O)
\label{eq:total}
\end{equation}

\noindent where (all time units are in seconds) T is the exposure time, E is the total open shutter time to complete the request, O is the total overhead time to complete the request, N$_e$ is the number of exposures per visit, N$_v$ is the number of visits per night, and N$_u$ is the number of unique nights to be observed. We charge 45 seconds for each exposure to account for readout time; however, we do not charge for readout on single exposure observations as in this case the readout is performed during slew time and therefore should not be double charged. Next we charge 200 seconds per visit to the target, which primarily relates to the average slew and target acquisition time. This 200s charge also encompasses global time sinks that are evenly spread across all targets, including things like: focuses, calibration exposures, temporary instrument or software failures, and unscheduled pauses for any number of reasons. The total open shutter and total overhead times are added to compute the total time to complete the request, which is converted to units of hours for ease of interpreting. In the table below, the column labeled ``Total Time (hr)" is the sum of open shutter time and overheads for a given target. The ``Total Time Required (hr)" number at the top of this page is the sum of `Total Time (hr)" column in the table below and therefore also includes all overhead charges. This represents the minimum amount of time this program must be awarded in order to complete all requested observations. We generally assume that 1 Night = 10 hours. \\

\LARGE
\underline{Feasibility} \\
\normalsize
\par The ``Feasible?" column denotes whether the request has passed a few simple checks for the feasibility of completing the request. The queue manager(s) \textbf{\textit{never}} guarantee that a request \textbf{\textit{will}} be completed in full. However, they can easily determine if a request  \textbf{\textit{cannot}} be completed in full. There are currently 4 checks of feasibility; failing any one of them deems the request as not feasible.

\begin{itemize}[topsep=3pt, partopsep=3pt, itemsep=3pt, parsep=3pt]
    \item a) For the average semester, the KPF-CC queue typically is awarded time on 60 unique calendar nights. If a PI requests more unique night observations than this, the request is not feasible. That said, 60 unique nights is a historical average and any single semester may have more or less. We urge the TAC to use their discretion when interpreting a request that the autoscheduler deems as not feasible under this scenario.
    \item b) A given target, based on it's RA/Dec, may not be accessible from Keck Observatory on every calendar night in the semester. We compute the rise and set date within the semester and if the number of days between them is exceeded by the number of unique night observations requested, then the request is not feasible.
    \item c) A semester has $\sim$180 calendar days in it. This represents the maximum baseline of observations for a given target. The autoscheduler multiplies the requested number of unique nights by the requested minimum inter-night cadence to compute the minimum baseline required for the request. If this value exceeds 180, the request is not feasible.
    \item d) Similarly, if the minimum baseline required for the request exceeds the number of days between the rise and set date for the given target, then the request is not feasible.
\end{itemize}

\par In the table below, if a target is deemed not feasible, the accompanying superscript denotes which of the four scenarios above are violated. Some targets may violate multiple feasibility scenarios. \\

\LARGE
\underline{Weather Considerations} \\
\normalsize
\par The KPF-CC queue is the only program at Keck Observatory that is all but guaranteed to lose on-sky time to weather. As we are spread out onto $~\sim$60 unique calendar nights in a semester, we expect to lose some of these nights or portions of them to poor weather which either forces us to abandon pre-planned schedules in favor of brighter stars that no program has requested, or close the dome entirely. Historically, the queue loses 30\% of allocated time to poor weather. We advise PI's that they may wish to consider proposing for up to 30\% \textit{more} time for their program than what would be required to complete the program if weather were no issue (the ``Total Time Required (hr)" at the top). Proposing for this extra time is asking for a hedge against realistic weather losses. If a program is selected by the TAC, it is further up to the TAC to determine if and how much of this time extra they wish to award.

\pagebreak

\LARGE
\underline{Observational Requests} \\
\normalsize

\renewcommand{\arraystretch}{3.5}
\begin{longtable}
{|>{\centering\arraybackslash}m{0.18\linewidth}|>{\centering\arraybackslash}m{0.08\linewidth}|>{\centering\arraybackslash}m{0.45\linewidth}|>{\centering\arraybackslash}m{0.1\linewidth}|>{\centering\arraybackslash}m{0.1\linewidth}|}
    \hline
    \fontsize{\fsizeb}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Target}} & \fontsize{\fsizeb}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Exp. Time (s)}} & \fontsize{\fsizeb}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Observational Strategy}} & \fontsize{\fsizeb}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Total Time (hr)}} & \fontsize{\fsizeb}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Feasible?}} \\
    \hline
    \hline
    \endfirsthead
    \multicolumn{5}{c}%
    {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
    \hline
    \fontsize{\fsize}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Target}} & \fontsize{\fsize}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Exp. Time (s)}} & \fontsize{\fsize}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Observational Strategy}} & \fontsize{\fsize}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Total Time$^*$ (hr)}} & \fontsize{\fsize}{14}\selectfont\parbox[c]{\linewidth}{\centering \textbf{Feasible?}} \\
    \hline
    \hline
    \endhead
    \hline \multicolumn{5}{|r|}{{Continued on next page}} \\ \hline
    \endfoot
    \hline
    \endlastfoot
\hline
% paste in table lines here
