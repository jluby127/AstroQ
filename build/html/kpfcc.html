

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kpfcc package &mdash; AstroQ 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to AstroQ_docs’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            AstroQ
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">kpfcc package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.access">Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.build_single_target_accessibility"><code class="docutils literal notranslate"><span class="pre">build_single_target_accessibility()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.build_twilight_map"><code class="docutils literal notranslate"><span class="pre">build_twilight_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.construct_access_dict"><code class="docutils literal notranslate"><span class="pre">construct_access_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.construct_twilight_map"><code class="docutils literal notranslate"><span class="pre">construct_twilight_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.convert_slot_to_quarter"><code class="docutils literal notranslate"><span class="pre">convert_slot_to_quarter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.determine_twilight_edge"><code class="docutils literal notranslate"><span class="pre">determine_twilight_edge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.generate_twilight_times"><code class="docutils literal notranslate"><span class="pre">generate_twilight_times()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.get_accessibility_stats"><code class="docutils literal notranslate"><span class="pre">get_accessibility_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.get_available_slots_per_night"><code class="docutils literal notranslate"><span class="pre">get_available_slots_per_night()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.is_observable"><code class="docutils literal notranslate"><span class="pre">is_observable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.moon_safe"><code class="docutils literal notranslate"><span class="pre">moon_safe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.read_accessibilty_map_dict"><code class="docutils literal notranslate"><span class="pre">read_accessibilty_map_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.single_night_allocated_slots"><code class="docutils literal notranslate"><span class="pre">single_night_allocated_slots()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.access.write_accessibilty_map_dict"><code class="docutils literal notranslate"><span class="pre">write_accessibilty_map_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.constraints">Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.constraints.GorubiModel"><code class="docutils literal notranslate"><span class="pre">GorubiModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_all_portions_of_night_represented"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_all_portions_of_night_represented()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_build_enforce_intranight_cadence"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_build_enforce_intranight_cadence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_build_theta"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_build_theta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_build_theta_multivisit"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_build_theta_multivisit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_build_theta_program_normalized"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_build_theta_program_normalized()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_build_theta_time_normalized"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_build_theta_time_normalized()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_cannot_observe_if_not_allocated"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_cannot_observe_if_not_allocated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_connect_Wrd_and_Yrds"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_connect_Wrd_and_Yrds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_enforce_internight_cadence"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_enforce_internight_cadence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_enforce_restricted_nights"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_enforce_restricted_nights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_fix_previous_objective"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_fix_previous_objective()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_forbidden_quarter_patterns"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_forbidden_quarter_patterns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_max_consecutive_onsky"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_max_consecutive_onsky()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_max_visits_per_night"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_max_visits_per_night()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_maximize_baseline"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_maximize_baseline()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_minimum_consecutive_offsky"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_minimum_consecutive_offsky()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_one_request_per_slot"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_one_request_per_slot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_relate_allocation_and_onsky"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_relate_allocation_and_onsky()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_reserve_multislot_exposures"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_reserve_multislot_exposures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_max_absolute_unique_nights_Wrd"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_max_absolute_unique_nights_Wrd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_max_absolute_unique_nights_Yrds"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_max_absolute_unique_nights_Yrds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_max_desired_unique_nights_Wrd"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_max_desired_unique_nights_Wrd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_max_desired_unique_nights_Yrds"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_max_desired_unique_nights_Yrds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_max_onsky_allocated"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_max_onsky_allocated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_max_quarters_allocated"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_max_quarters_allocated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.constraint_set_min_max_visits_per_night"><code class="docutils literal notranslate"><span class="pre">GorubiModel.constraint_set_min_max_visits_per_night()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.remove_constraint_set_max_desired_unique_nights_Wrd"><code class="docutils literal notranslate"><span class="pre">GorubiModel.remove_constraint_set_max_desired_unique_nights_Wrd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.set_objective_maximize_slots_used"><code class="docutils literal notranslate"><span class="pre">GorubiModel.set_objective_maximize_slots_used()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.set_objective_minimize_theta"><code class="docutils literal notranslate"><span class="pre">GorubiModel.set_objective_minimize_theta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.set_objective_minimize_theta_prog_norm"><code class="docutils literal notranslate"><span class="pre">GorubiModel.set_objective_minimize_theta_prog_norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.set_objective_minimize_theta_time_normalized"><code class="docutils literal notranslate"><span class="pre">GorubiModel.set_objective_minimize_theta_time_normalized()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.constraints.GorubiModel.solve_model"><code class="docutils literal notranslate"><span class="pre">GorubiModel.solve_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.constraints.define_slot_index_frame"><code class="docutils literal notranslate"><span class="pre">define_slot_index_frame()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.history">History</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.access_jump"><code class="docutils literal notranslate"><span class="pre">access_jump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.build_past_history"><code class="docutils literal notranslate"><span class="pre">build_past_history()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.get_database_explorer"><code class="docutils literal notranslate"><span class="pre">get_database_explorer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.get_kpf_past_database"><code class="docutils literal notranslate"><span class="pre">get_kpf_past_database()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.get_nobs_on_night"><code class="docutils literal notranslate"><span class="pre">get_nobs_on_night()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.get_quarter_observed"><code class="docutils literal notranslate"><span class="pre">get_quarter_observed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.history.get_unique_nights"><code class="docutils literal notranslate"><span class="pre">get_unique_nights()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.io">IO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.build_fullness_report"><code class="docutils literal notranslate"><span class="pre">build_fullness_report()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.build_observed_map_future"><code class="docutils literal notranslate"><span class="pre">build_observed_map_future()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.build_observed_map_past"><code class="docutils literal notranslate"><span class="pre">build_observed_map_past()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.determine_quarter"><code class="docutils literal notranslate"><span class="pre">determine_quarter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.format_kpf_row"><code class="docutils literal notranslate"><span class="pre">format_kpf_row()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.pm_correcter"><code class="docutils literal notranslate"><span class="pre">pm_correcter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.report_allocation_stats"><code class="docutils literal notranslate"><span class="pre">report_allocation_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.write_available_human_readable"><code class="docutils literal notranslate"><span class="pre">write_available_human_readable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.write_out_results"><code class="docutils literal notranslate"><span class="pre">write_out_results()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.write_starlist"><code class="docutils literal notranslate"><span class="pre">write_starlist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.io.write_stars_schedule_human_readable"><code class="docutils literal notranslate"><span class="pre">write_stars_schedule_human_readable()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.management">Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.management.build_date_dictionary"><code class="docutils literal notranslate"><span class="pre">build_date_dictionary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.management.compute_slots_required_for_exposure"><code class="docutils literal notranslate"><span class="pre">compute_slots_required_for_exposure()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.management.data_admin"><code class="docutils literal notranslate"><span class="pre">data_admin</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.management.data_admin.build_slots_required_dictionary"><code class="docutils literal notranslate"><span class="pre">data_admin.build_slots_required_dictionary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.management.data_admin.run_admin"><code class="docutils literal notranslate"><span class="pre">data_admin.run_admin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.management.get_gap_filler_targets"><code class="docutils literal notranslate"><span class="pre">get_gap_filler_targets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.management.get_semester_info"><code class="docutils literal notranslate"><span class="pre">get_semester_info()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.maps">Maps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.build_allocation_map"><code class="docutils literal notranslate"><span class="pre">build_allocation_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.compute_on_off_for_quarter"><code class="docutils literal notranslate"><span class="pre">compute_on_off_for_quarter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.construct_custom_map_dict"><code class="docutils literal notranslate"><span class="pre">construct_custom_map_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.construct_nonqueue_arr"><code class="docutils literal notranslate"><span class="pre">construct_nonqueue_arr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.construct_zero_out_arr"><code class="docutils literal notranslate"><span class="pre">construct_zero_out_arr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.convert_allocation_array_to_binary"><code class="docutils literal notranslate"><span class="pre">convert_allocation_array_to_binary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.convert_utc_to_hst"><code class="docutils literal notranslate"><span class="pre">convert_utc_to_hst()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.format_keck_allocation_info"><code class="docutils literal notranslate"><span class="pre">format_keck_allocation_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.prepare_allocation_map"><code class="docutils literal notranslate"><span class="pre">prepare_allocation_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.produce_ultimate_map"><code class="docutils literal notranslate"><span class="pre">produce_ultimate_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.quarter_translator"><code class="docutils literal notranslate"><span class="pre">quarter_translator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.quarters_observable"><code class="docutils literal notranslate"><span class="pre">quarters_observable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.maps.round_time_to_slot"><code class="docutils literal notranslate"><span class="pre">round_time_to_slot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.onsky">Onsky</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.onsky.prepare_for_ttp"><code class="docutils literal notranslate"><span class="pre">prepare_for_ttp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.onsky.produce_bright_backups"><code class="docutils literal notranslate"><span class="pre">produce_bright_backups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.onsky.run_ttp"><code class="docutils literal notranslate"><span class="pre">run_ttp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.plot">Plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.build_multi_request_cof"><code class="docutils literal notranslate"><span class="pre">build_multi_request_cof()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.create_single_program_birds_eye"><code class="docutils literal notranslate"><span class="pre">create_single_program_birds_eye()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.generate_admin_view_plot_suite"><code class="docutils literal notranslate"><span class="pre">generate_admin_view_plot_suite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.generate_birds_eye"><code class="docutils literal notranslate"><span class="pre">generate_birds_eye()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.generate_cadence_view_plot"><code class="docutils literal notranslate"><span class="pre">generate_cadence_view_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.generate_single_program_plot_suite"><code class="docutils literal notranslate"><span class="pre">generate_single_program_plot_suite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.process_single_target_for_birds_eye"><code class="docutils literal notranslate"><span class="pre">process_single_target_for_birds_eye()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.programmatic_cof"><code class="docutils literal notranslate"><span class="pre">programmatic_cof()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.run_plot_suite"><code class="docutils literal notranslate"><span class="pre">run_plot_suite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.single_request_cof"><code class="docutils literal notranslate"><span class="pre">single_request_cof()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.write_cadence_plot_files"><code class="docutils literal notranslate"><span class="pre">write_cadence_plot_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.plot.write_one_cadence_plot_file"><code class="docutils literal notranslate"><span class="pre">write_one_cadence_plot_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.schedule">Schedule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.schedule.run_kpfcc"><code class="docutils literal notranslate"><span class="pre">run_kpfcc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.tracking">Tracking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.tracking.StarTracker"><code class="docutils literal notranslate"><span class="pre">StarTracker</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.tracking.StarTracker.create_folders"><code class="docutils literal notranslate"><span class="pre">StarTracker.create_folders()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.tracking.StarTracker.get_star_first_forecast"><code class="docutils literal notranslate"><span class="pre">StarTracker.get_star_first_forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.tracking.StarTracker.get_star_forecast"><code class="docutils literal notranslate"><span class="pre">StarTracker.get_star_forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.tracking.StarTracker.get_star_past"><code class="docutils literal notranslate"><span class="pre">StarTracker.get_star_past()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.tracking.StarTracker.get_star_stats"><code class="docutils literal notranslate"><span class="pre">StarTracker.get_star_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpfcc.tracking.StarTracker.write_star_first_forecast"><code class="docutils literal notranslate"><span class="pre">StarTracker.write_star_first_forecast()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc.weather">Weather</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.compute_hours_observable_tonight"><code class="docutils literal notranslate"><span class="pre">compute_hours_observable_tonight()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.compute_yearly_accessibility"><code class="docutils literal notranslate"><span class="pre">compute_yearly_accessibility()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.get_loss_stats"><code class="docutils literal notranslate"><span class="pre">get_loss_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.get_stars_for_tonight"><code class="docutils literal notranslate"><span class="pre">get_stars_for_tonight()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.get_times_worth"><code class="docutils literal notranslate"><span class="pre">get_times_worth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.simulate_weather_losses"><code class="docutils literal notranslate"><span class="pre">simulate_weather_losses()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kpfcc.weather.write_out_weather_stats"><code class="docutils literal notranslate"><span class="pre">write_out_weather_stats()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kpfcc">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AstroQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">kpfcc package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/kpfcc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kpfcc-package">
<h1>kpfcc package<a class="headerlink" href="#kpfcc-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-kpfcc.access">
<span id="access"></span><h2>Access<a class="headerlink" href="#module-kpfcc.access" title="Link to this heading"></a></h2>
<p>Module for computing acccessibility of requests, including from telescope pointing and twilight</p>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.build_single_target_accessibility">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">build_single_target_accessibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nights_in_semester</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observatory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_turn_on_off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#build_single_target_accessibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.build_single_target_accessibility" title="Link to this definition"></a></dt>
<dd><p>Compute a target’s accessibility map for the entire semester</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starname</strong> (<em>str</em>) – the name of the star (simbad resolvable)</p></li>
<li><p><strong>ra</strong> (<em>str</em>) – the right ascension in hour angle degrees (ie. 14.33)</p></li>
<li><p><strong>dec</strong> (<em>str</em>) – the declination in degrees (ie. +75.2)</p></li>
<li><p><strong>start_date</strong> (<em>str</em>) – the calendar date to begin the calculation from (format is Astropy isot)</p></li>
<li><p><strong>n_nights_in_semester</strong> (<em>str</em>) – the number of calendar nights remaining in the current semester</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of the slots in minutes</p></li>
<li><p><strong>observatory</strong> (<em>str</em>) – the Astropy and Astroplan resolvable name for an observatory</p></li>
<li><p><strong>compute_turn_on_off</strong> (<em>boolean</em>) – a flag to determine whether or not to compute</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length n_slots_in_semester where 1 indicates</dt><dd><p>the target is accessible in that slot and 0 otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>target_accessibility (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.build_twilight_map">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">build_twilight_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">available_slots_in_night</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_slots_in_night</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#build_twilight_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.build_twilight_map" title="Link to this definition"></a></dt>
<dd><p>Create the 1D twilight times map for all slots in the semester</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>available_slots_in_night</strong> (<em>array</em>) – a 1D array of length n_nights_in_semester where each
element has an integer representing the number of slots
within that night that are between twilight times</p></li>
<li><p><strong>n_slots_in_night</strong> (<em>int</em>) – the number of slots in a single night</p></li>
<li><p><strong>invert</strong> (<em>boolean</em>) – if true, flip the 1’s and 0’s designation. Useful because by default 0’s
mean we are not in day/twilight and 1’s mean we are in night time but for
adding purposes it is useful to invert this schema and then np.sum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>1D array of length n_slots_in_semester where 1’s indicate the</dt><dd><p>slots during night time and 0’s during the day time/twilight</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nightly_twilight_map (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.construct_access_dict">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">construct_access_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#construct_access_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.construct_access_dict" title="Link to this definition"></a></dt>
<dd><p>Define the dictionary of accessibility maps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>keys are the starnames and values are the 1D access maps</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>default_access_maps (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.construct_twilight_map">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">construct_twilight_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#construct_twilight_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.construct_twilight_map" title="Link to this definition"></a></dt>
<dd><p>Compute the number of slots per night available, based on strictly twilight times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_day</strong> (<em>str</em>) – today’s date, format YYYY-MM-DD</p></li>
<li><p><strong>twilight_frame</strong> (<em>dataframe</em>) – the pandas dataframe containing twilight information</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of a single slot, in minutes</p></li>
<li><p><strong>all_dates_dict</strong> (<em>dictionary</em>) – keys are calendar days, values are day of the semester</p></li>
<li><p><strong>n_slots_in_night</strong> (<em>int</em>) – the number of slots in single night, regardless of twilight</p></li>
<li><p><strong>n_nights_in_semester</strong> (<em>int</em>) – the number of nigths remaining in the semester</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 1D array where elements are 1 or 0 based if outside or inside of twilight time
twilight_map_remaining_2D (array): a 2D version of the same information</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>twilight_map_remaining_flat (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.convert_slot_to_quarter">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">convert_slot_to_quarter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">twilight_map_remaining_2D_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#convert_slot_to_quarter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.convert_slot_to_quarter" title="Link to this definition"></a></dt>
<dd><p>Determine the slot numbers within the night that breaks the night into “equal” length quarters
Take extra precaution when the total number of slots between twilight times is not easily
divisable by 4.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.determine_twilight_edge">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">determine_twilight_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'03:30'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hours_in_night</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#determine_twilight_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.determine_twilight_edge" title="Link to this definition"></a></dt>
<dd><p>Determine how many slots within each night actually take place during night time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> (<em>-</em>) – the calendar date of the semester. Format: YYYY-MM-DD.</p></li>
<li><p><strong>twilight_frame</strong> (<em>-</em>) – the dataframe containing pre-computed</p></li>
<li><p><strong>slot_size</strong> (<em>-</em>) – the size of the a slot in minutes</p></li>
<li><p><strong>start_time</strong> (<em>-</em>) – the time representing the first slot of the night, format HH:MM</p></li>
<li><p><strong>n_hours_in_night</strong> (<em>-</em>) – number of hours in a night</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the number of slots in night that are night time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>available_slots_in_night (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.generate_twilight_times">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">generate_twilight_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_dates_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#generate_twilight_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.generate_twilight_times" title="Link to this definition"></a></dt>
<dd><p>Precompute a dataframe of the morning/evening twilight times for each day in the semester</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>all_dates_array</strong> (<em>list</em>) – the calendar dates of the semester.
Format: YYYY-MM-DD.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the precomputed twilight times</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>twilight_frame (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.get_accessibility_stats">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">get_accessibility_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">access_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#get_accessibility_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.get_accessibility_stats" title="Link to this definition"></a></dt>
<dd><p>Compute stats useful for checking feasibilty and for generating the cadence plot of a target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>access_map</strong> (<em>array</em>) – a 2D array of shape n_nights_in_semester by n_slots_in_night where 1’s
indicate the target is accessible</p></li>
<li><p><strong>time_up</strong> (<em>int</em>) – the minimum number of minutes a target must be accessible in the night to be
considered observable in that night</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of the slots in minutes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the number of days in the semester where the target achieves a</dt><dd><p>minimum level of observablility</p>
</dd>
</dl>
<p>rise_day (int): the number of days from semester start where the target is first available
set_day (int): the number of days from semester start where the target is last available</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>days_observable (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.get_available_slots_per_night">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">get_available_slots_per_night</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_dates_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'03:30'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hours_in_night</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#get_available_slots_per_night"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.get_available_slots_per_night" title="Link to this definition"></a></dt>
<dd><p>Generates a 1D list of length equal to the number of nights in the semester where each element
is the integer number of slots that are available to the scheduler in that night</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_dates_array</strong> (<em>list</em>) – the calendar dates of the semester.
Format: YYYY-MM-DD.</p></li>
<li><p><strong>twilight_frame</strong> (<em>dataframe</em>) – the precomputed twilight times</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.is_observable">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">is_observable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observatory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#is_observable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.is_observable" title="Link to this definition"></a></dt>
<dd><p>Compute a target’s accessibility map on a given date, taking into account the
telescope pointing limits and moon-safe distance at the beginning of every slot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observatory</strong> (<em>str</em>) – the Astropy and Astroplan resolvable name for an observatory</p></li>
<li><p><strong>date</strong> (<em>str</em>) – the calendar date to compute accessibilty in format ‘YYYY-MM-DD’</p></li>
<li><p><strong>target</strong> (<em>str</em>) – an astroplan FixedTarget object</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of the slots in minutes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length n_slots_in_night where 1 indicates the</dt><dd><p>target is accessible in that slot and 0 otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>observability_matrix (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.moon_safe">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">moon_safe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tuple</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#moon_safe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.moon_safe" title="Link to this definition"></a></dt>
<dd><p>Check that a coordinate is not too close to the moon.
Returns true if target is sufficiently far from the moon to allow for observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moon</strong> (<em>str</em>) – a “moon object” from Astropy</p></li>
<li><p><strong>target_tuple</strong> (<em>tuple</em>) – the RA and Dec of a target star in hourangle and degrees format</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unnamed boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.read_accessibilty_map_dict">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">read_accessibilty_map_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#read_accessibilty_map_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.read_accessibilty_map_dict" title="Link to this definition"></a></dt>
<dd><p>Read the accessibilty maps for each target from pre-written file. Must reformat the data to
array because the array is technically saved as a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename where the saved dictionary is stored.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary where keys are target names, values are 1D arrays of</dt><dd><p>length n_slots_in_semester indicating if a target is accessible (1)
or inaccessible (0) due to default telescope pointing limits, seasonal
rise/set, and moon-safe distance.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>access_dict (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.single_night_allocated_slots">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">single_night_allocated_slots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocated_quarters_tonight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_slots_in_night</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_slots_in_night</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#single_night_allocated_slots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.single_night_allocated_slots" title="Link to this definition"></a></dt>
<dd><p>Determine the slots of a single night that are allocated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocated_quarters_tonight</strong> (<em>array</em>) – a 1D array of length n_quarters_in_night,
[Q1, Q2, Q3, Q4] where binary elements indicate allocation.</p></li>
<li><p><strong>available_slots_in_night</strong> (<em>array</em>) – a 1D array of length n_nights_in_semester where each
element is an integer representing the number of slots within that
night that during night time</p></li>
<li><p><strong>n_slots_in_night</strong> (<em>int</em>) – the number of slots in a single night</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length n_slots_in_night</dt><dd><p>where 1’s are the allocated slots that on night n and 0’s are not allocated</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>allocated_slots_tonight (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.access.write_accessibilty_map_dict">
<span class="sig-prename descclassname"><span class="pre">kpfcc.access.</span></span><span class="sig-name descname"><span class="pre">write_accessibilty_map_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">access_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/access.html#write_accessibilty_map_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.access.write_accessibilty_map_dict" title="Link to this definition"></a></dt>
<dd><p>Write entries to the accessbility map dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>access_dict</strong> (<em>dict</em>) – the pre-generated accessibility map dictionary. Keys are target names,
values are 1D arrays of length n_slots_in_semester indicating if a
target is accessible (1) or inaccessible (0) due to default telescope
pointing limits, seasonal rise/set, and moon-safe distance.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – the name of the file to re-save the updated dicationary.
Best to match the original name and overwrite.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.constraints">
<span id="constraints"></span><h2>Constraints<a class="headerlink" href="#module-kpfcc.constraints" title="Link to this heading"></a></h2>
<p>Module for building constraints</p>
<p>This module constructs constraints for the gurobi model.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import constraints_functions as cf</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kpfcc.constraints.</span></span><span class="sig-name descname"><span class="pre">GorubiModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Aset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Aframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedulable_requests</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Gorubi Model object, from which we can add constraints and share variables easily.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_all_portions_of_night_represented">
<span class="sig-name descname"><span class="pre">constraint_all_portions_of_night_represented</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_all_portions_of_night_represented"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_all_portions_of_night_represented" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_build_enforce_intranight_cadence">
<span class="sig-name descname"><span class="pre">constraint_build_enforce_intranight_cadence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_build_enforce_intranight_cadence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_build_enforce_intranight_cadence" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_build_theta">
<span class="sig-name descname"><span class="pre">constraint_build_theta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_build_theta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_build_theta" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_build_theta_multivisit">
<span class="sig-name descname"><span class="pre">constraint_build_theta_multivisit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_build_theta_multivisit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_build_theta_multivisit" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_build_theta_program_normalized">
<span class="sig-name descname"><span class="pre">constraint_build_theta_program_normalized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_build_theta_program_normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_build_theta_program_normalized" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_build_theta_time_normalized">
<span class="sig-name descname"><span class="pre">constraint_build_theta_time_normalized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_build_theta_time_normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_build_theta_time_normalized" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_cannot_observe_if_not_allocated">
<span class="sig-name descname"><span class="pre">constraint_cannot_observe_if_not_allocated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">twilight_map_remaining_2D</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_cannot_observe_if_not_allocated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_cannot_observe_if_not_allocated" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_connect_Wrd_and_Yrds">
<span class="sig-name descname"><span class="pre">constraint_connect_Wrd_and_Yrds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_connect_Wrd_and_Yrds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_connect_Wrd_and_Yrds" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_enforce_internight_cadence">
<span class="sig-name descname"><span class="pre">constraint_enforce_internight_cadence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_enforce_internight_cadence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_enforce_internight_cadence" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_enforce_restricted_nights">
<span class="sig-name descname"><span class="pre">constraint_enforce_restricted_nights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_enforce_restricted_nights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_enforce_restricted_nights" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>limit</strong> (<em>int</em>) – either 0 or 1 to enforce blackout and whiteout, respectively</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_fix_previous_objective">
<span class="sig-name descname"><span class="pre">constraint_fix_previous_objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_fix_previous_objective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_fix_previous_objective" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_forbidden_quarter_patterns">
<span class="sig-name descname"><span class="pre">constraint_forbidden_quarter_patterns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_forbidden_quarter_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_forbidden_quarter_patterns" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_max_consecutive_onsky">
<span class="sig-name descname"><span class="pre">constraint_max_consecutive_onsky</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_max_consecutive_onsky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_max_consecutive_onsky" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_max_visits_per_night">
<span class="sig-name descname"><span class="pre">constraint_max_visits_per_night</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_max_visits_per_night"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_max_visits_per_night" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_maximize_baseline">
<span class="sig-name descname"><span class="pre">constraint_maximize_baseline</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_maximize_baseline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_maximize_baseline" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_minimum_consecutive_offsky">
<span class="sig-name descname"><span class="pre">constraint_minimum_consecutive_offsky</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_minimum_consecutive_offsky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_minimum_consecutive_offsky" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_one_request_per_slot">
<span class="sig-name descname"><span class="pre">constraint_one_request_per_slot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_one_request_per_slot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_one_request_per_slot" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_relate_allocation_and_onsky">
<span class="sig-name descname"><span class="pre">constraint_relate_allocation_and_onsky</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_relate_allocation_and_onsky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_relate_allocation_and_onsky" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_reserve_multislot_exposures">
<span class="sig-name descname"><span class="pre">constraint_reserve_multislot_exposures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_reserve_multislot_exposures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_reserve_multislot_exposures" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_max_absolute_unique_nights_Wrd">
<span class="sig-name descname"><span class="pre">constraint_set_max_absolute_unique_nights_Wrd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_max_absolute_unique_nights_Wrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_max_absolute_unique_nights_Wrd" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_max_absolute_unique_nights_Yrds">
<span class="sig-name descname"><span class="pre">constraint_set_max_absolute_unique_nights_Yrds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_max_absolute_unique_nights_Yrds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_max_absolute_unique_nights_Yrds" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_max_desired_unique_nights_Wrd">
<span class="sig-name descname"><span class="pre">constraint_set_max_desired_unique_nights_Wrd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_max_desired_unique_nights_Wrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_max_desired_unique_nights_Wrd" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_max_desired_unique_nights_Yrds">
<span class="sig-name descname"><span class="pre">constraint_set_max_desired_unique_nights_Yrds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_max_desired_unique_nights_Yrds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_max_desired_unique_nights_Yrds" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_max_onsky_allocated">
<span class="sig-name descname"><span class="pre">constraint_set_max_onsky_allocated</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_max_onsky_allocated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_max_onsky_allocated" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_max_quarters_allocated">
<span class="sig-name descname"><span class="pre">constraint_set_max_quarters_allocated</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_max_quarters_allocated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_max_quarters_allocated" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.constraint_set_min_max_visits_per_night">
<span class="sig-name descname"><span class="pre">constraint_set_min_max_visits_per_night</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.constraint_set_min_max_visits_per_night"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.constraint_set_min_max_visits_per_night" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.remove_constraint_set_max_desired_unique_nights_Wrd">
<span class="sig-name descname"><span class="pre">remove_constraint_set_max_desired_unique_nights_Wrd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.remove_constraint_set_max_desired_unique_nights_Wrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.remove_constraint_set_max_desired_unique_nights_Wrd" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.set_objective_maximize_slots_used">
<span class="sig-name descname"><span class="pre">set_objective_maximize_slots_used</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.set_objective_maximize_slots_used"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.set_objective_maximize_slots_used" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.set_objective_minimize_theta">
<span class="sig-name descname"><span class="pre">set_objective_minimize_theta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.set_objective_minimize_theta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.set_objective_minimize_theta" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.set_objective_minimize_theta_prog_norm">
<span class="sig-name descname"><span class="pre">set_objective_minimize_theta_prog_norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.set_objective_minimize_theta_prog_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.set_objective_minimize_theta_prog_norm" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.set_objective_minimize_theta_time_normalized">
<span class="sig-name descname"><span class="pre">set_objective_minimize_theta_time_normalized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.set_objective_minimize_theta_time_normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.set_objective_minimize_theta_time_normalized" title="Link to this definition"></a></dt>
<dd><p>According to Eq X in Lubin et al. 2025.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.constraints.GorubiModel.solve_model">
<span class="sig-name descname"><span class="pre">solve_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#GorubiModel.solve_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.GorubiModel.solve_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.constraints.define_slot_index_frame">
<span class="sig-prename descclassname"><span class="pre">kpfcc.constraints.</span></span><span class="sig-name descname"><span class="pre">define_slot_index_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_indices_for_request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/constraints.html#define_slot_index_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.constraints.define_slot_index_frame" title="Link to this definition"></a></dt>
<dd><p>Using the dictionary of indices where each request is available, define a dataframe for which
we will use to cut/filter/merge r,d,s tuples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>requests_frame</strong> (<em>dataframe</em>) – the pandas dataframe containing the request information</p></li>
<li><p><strong>slots_needed_for_exposure_dict</strong> (<em>dictionary</em>) – keys are the request names, values are the
number of slots required for one exposure of that request</p></li>
<li><p><strong>available_indices_for_request</strong> (<em>dictionary</em>) – keys are the starnames and values are a 1D array
the indices where available_slots_for_request is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a pandas dataframe containing one row for each valid r,d,s tuple
Aset (array): an array of [r, d, s] tuples that make up the indices of Yrds
schedulable_requests (list): the requests that are valid for this schedule</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Aframe (dataframe)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.history">
<span id="history"></span><h2>History<a class="headerlink" href="#module-kpfcc.history" title="Link to this heading"></a></h2>
<p>Module for processing the inputs and outputs of the autoscheduler to/from various sources.
Designed to be only run as a function call from the generateScript.py script.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import processing_functions as pf</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.access_jump">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">access_jump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#access_jump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.access_jump" title="Link to this definition"></a></dt>
<dd><p>Access the Jump database. You will need correct permissions to access this secured database
hosted by Caltech Cadence servers. Eventually we will pull from the Keck Observatory Archive
(KOA) directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a session request</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>s (object)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.build_past_history">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">build_past_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_observations_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requests_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#build_past_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.build_past_history" title="Link to this definition"></a></dt>
<dd><p>Construct the past history dictionary having pulled a table of observations from Jump.
Later this function will be replaced by one which pulls history from Keck OB database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>past_observations_file</strong> (<em>str</em>) – the path and filename of the csv pulled from Jump</p></li>
<li><p><strong>requests_frame</strong> (<em>dataframe</em>) – the dataframe containing the request information</p></li>
<li><p><strong>twilight_frame</strong> (<em>dataframe</em>) – the dataframe containing the twilight information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>contains keys of starnames and values are lists where</dt><dd><p>elements follow order described below.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>database_info_dict (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.get_database_explorer">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">get_database_explorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_for_csv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'https://jump.caltech.edu/explorer/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#get_database_explorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.get_database_explorer" title="Link to this definition"></a></dt>
<dd><p>Pull the relevant query from the Jump database.
Eventually we will pull from the Keck Observatory Archive (KOA) directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – the name of the pre-built query in the Jump database</p></li>
<li><p><strong>path_for_csv</strong> (<em>str</em>) – the link to the Jump database</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.get_kpf_past_database">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">get_kpf_past_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_csv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#get_kpf_past_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.get_kpf_past_database" title="Link to this definition"></a></dt>
<dd><p>A user-friendly front facing function to pull past observations from the Jump database.
Note that each semester, you will have to log into Jump, find this pre-built query,
and manually update the start and end date fields.
Eventually we will pull from the Keck Observatory Archive (KOA) directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path_to_csv</strong> (<em>str</em>) – the directory to save the data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.get_nobs_on_night">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">get_nobs_on_night</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_past_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_hst_dates_observed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#get_nobs_on_night"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.get_nobs_on_night" title="Link to this definition"></a></dt>
<dd><p>Determine how many exposures were taken of a target on a given night</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_past_obs</strong> (<em>dataframe</em>) – the updated version of the original variable which now includes
columns for UTC date and hst date</p></li>
<li><p><strong>unique_hst_dates_observed</strong> (<em>array</em>) – a 1D array of HST dates where the star was observed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length equal to length unique_hst_dates_observed where</dt><dd><p>each element is an integer of the number of exposures taken that night</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>n_obs_on_date (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.get_quarter_observed">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">get_quarter_observed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utc_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#get_quarter_observed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.get_quarter_observed" title="Link to this definition"></a></dt>
<dd><p>Determine which quarter of the night an observation was taken in</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestamp</strong> (<em>float</em>) – a BJD value indicating the time of the observation</p></li>
<li><p><strong>utc_date</strong> (<em>str</em>) – the calendar date of the observation in UTC, format ‘YYYY-MM-DD’</p></li>
<li><p><strong>twilight_frame</strong> (<em>dataframe</em>) – the dataframe of morning and evening twilight times</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the quarter corresponding to the timestamp</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>quarter (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.history.get_unique_nights">
<span class="sig-prename descclassname"><span class="pre">kpfcc.history.</span></span><span class="sig-name descname"><span class="pre">get_unique_nights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_past_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/history.html#get_unique_nights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.history.get_unique_nights" title="Link to this definition"></a></dt>
<dd><p>Parse the Jump database for the previous nights where a given star was observed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_past_obs</strong> (<em>dataframe</em>) – a subset of the Jump database dataframe, filtered to only
include observations for a specific target name</p></li>
<li><p><strong>twilight_frame</strong> (<em>dataframe</em>) – the dataframe of morning and evening twilight times for each
night of the semester</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>an updated version of the original variable which now includes</dt><dd><p>columns for UTC date and hst date</p>
</dd>
<dt>unique_hst_dates_observed (array): a 1D array length # of unique dates observed where each</dt><dd><p>element is the HST date when the star was observed at least once</p>
</dd>
<dt>quarter_observed (array): a 1D array length # of unique dates observed where each element</dt><dd><p>the quarter of the night when the first of the observations
for that night was taken.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>star_past_obs (dataframe)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.io">
<span id="io"></span><h2>IO<a class="headerlink" href="#module-kpfcc.io" title="Link to this heading"></a></h2>
<p>Module for building reports after the solution is found. Designed to be only run as a function
call from the generateScript.py script.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import reporting_functions as rf</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.build_fullness_report">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">build_fullness_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combined_semester_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#build_fullness_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.build_fullness_report" title="Link to this definition"></a></dt>
<dd><p>Determine how full the schedule is: slots available, slots scheduled, and slots required</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>combined_semester_schedule</strong> (<em>array</em>) – a 2D array of dimensions n_nights_in_semester by
n_slots_in_night where elements denote how the slot is
used: target, twilight, weather, not scheduled.</p></li>
<li><p><strong>allocation_map_2D</strong> (<em>array</em>) – a 2D array where rows represent a night and columns represent
the quarter within that night. Values are 1 if that
night/quarter is allocated and 0 if not.</p></li>
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.build_observed_map_future">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">build_observed_map_future</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined_semester_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#build_observed_map_future"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.build_observed_map_future" title="Link to this definition"></a></dt>
<dd><p>Construct stage two (future) of the starmap which is then used to build the cadence plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
<li><p><strong>combined_semester_schedule</strong> (<em>array</em>) – a 2D array of dimensions n_nights_in_semester by
n_slots_in_night where elements denote how the slot is
used: target, twilight, weather, not scheduled.</p></li>
<li><p><strong>starname</strong> (<em>str</em>) – the request in question</p></li>
<li><p><strong>starmap</strong> (<em>dataframe</em>) – an updated starmap which includes the past history of the target</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an updated starmap which includes the past history of the target</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>starmap (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.build_observed_map_past">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">build_observed_map_past</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmap_template_filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#build_observed_map_past"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.build_observed_map_past" title="Link to this definition"></a></dt>
<dd><p>Construct stage one (past) of the starmap which is then used to build the cadence plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>past_info</strong> (<em>array</em>) – 2D array following schema of the values for the database_info_dict</p></li>
<li><p><strong>starmap_template_filename</strong> (<em>str</em>) – the path and filename of the starmap template</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an updated starmap which includes the past history of the target</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>starmap (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.determine_quarter">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">determine_quarter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_slots_in_night</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#determine_quarter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.determine_quarter" title="Link to this definition"></a></dt>
<dd><p>Given a slot number, determine what quarter it is to be observed in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>int</em>) – the slot number to be observed</p></li>
<li><p><strong>n_slots_in_night</strong> (<em>int</em>) – the number of slots in the night</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding quarter (1, 2, 3, 4) of the night</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>quarter (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.format_kpf_row">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">format_kpf_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_available</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_available</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filler_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#format_kpf_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.format_kpf_row" title="Link to this definition"></a></dt>
<dd><p>Format request data in the specific way needed for the script (relates to the Keck “Magiq”
software’s data ingestion requirements).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (<em>dataframe</em>) – a single row from the requests sheet dataframe</p></li>
<li><p><strong>obs_time</strong> (<em>str</em>) – the timestamp of the night to begin the exposure according to the TTP.
In format HH:MM in HST timezone</p></li>
<li><p><strong>first_available</strong> (<em>str</em>) – the timestamp of the night where the star is first accessible.
In format HH:MM in HST timezone.</p></li>
<li><p><strong>last_available</strong> (<em>str</em>) – the timestamp of the night where the star is last accessible.
In format HH:MM in HST timezone.</p></li>
<li><p><strong>filler_flag</strong> (<em>boolean</em>) – True of the target was added in the bonus round</p></li>
<li><p><strong>extra</strong> (<em>boolean</em>) – is this an “extra” target</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the properly formatted string to be included in the script file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>line (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.pm_correcter">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">pm_correcter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmdec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#pm_correcter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.pm_correcter" title="Link to this definition"></a></dt>
<dd><p>Update a star’s coordinates due to proper motion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra</strong> (<em>str</em>) – star’s old coordinate RA in units of degrees</p></li>
<li><p><strong>dec</strong> (<em>str</em>) – star’s old coordinate Dec in units of degrees</p></li>
<li><p><strong>pmra</strong> (<em>str</em>) – star’s proper motion in the RA dimension, units of millearcseconds per year</p></li>
<li><p><strong>pmdec</strong> (<em>str</em>) – star’s proper motion in the Dec dimension, units of millearcseconds per year</p></li>
<li><p><strong>epochstr</strong> (<em>str</em>) – a string of the year those coordinates are updated to</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – True to print out to command line</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated RA position in units of degrees
formatted_dec (str):  the updated Dec position in units of degrees</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>formatted_ra (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.report_allocation_stats">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">report_allocation_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#report_allocation_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.report_allocation_stats" title="Link to this definition"></a></dt>
<dd><p>Return the number of Q1, Q2, Q3, and Q4 nights, as well as single, half, three quarter
and full nights. Further produce a plot showing the allocation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
<li><p><strong>allocation_map_2D</strong> (<em>array</em>) – a 2D array where rows represent a night and columns represent
the quarter within that night. Values are 1 if that
night/quarter is allocated and 0 if not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.write_available_human_readable">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">write_available_human_readable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#write_available_human_readable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.write_available_human_readable" title="Link to this definition"></a></dt>
<dd><p>Fill in the human readable solution with the non-observation information: non-allocated slots,
weather loss slots, non-queue slots, twilight slots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
<li><p><strong>twilight_map</strong> (<em>array</em>) – the 1D array of length n_slots_in_semester where 1’s represent slots
not in night time and 0’s represent slots that are during day/twilight</p></li>
<li><p><strong>allocation_map_2D</strong> (<em>array</em>) – a 2D array where rows represent a night and columns represent
the quarter within that night. Values are 1 if that
night/quarter is allocated and 0 if not.</p></li>
<li><p><strong>weathered_map</strong> (<em>array</em>) – a 1D array of length s slots in semester where elements are 1 if
that slot has been modeled as lost to weather and 0 if not</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 2D array of dimensions n_nights_in_semester by</dt><dd><p>n_slots_in_night where elements denote how the slot is
used: target, twilight, weather, not scheduled.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>combined_semester_schedule (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.write_out_results">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">write_out_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_the_clock</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#write_out_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.write_out_results" title="Link to this definition"></a></dt>
<dd><p>Write the Run Report
:param manager: a data_admin object
:type manager: obj
:param model: a GurobiModel object
:type model: obj
:param rount: “Round1” or “Round2”
:type rount: str
:param start_the_clock: time object of when the scheduler code began
:type start_the_clock: obj</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.write_starlist">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">write_starlist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">night_start_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extras</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filler_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#write_starlist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.write_starlist" title="Link to this definition"></a></dt>
<dd><p>Generate the nightly script in the correct format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>dataframe</em>) – the csv of PI requests for just the targets that were selected
to be observed tonight</p></li>
<li><p><strong>solution_frame</strong> (<em>dataframe</em>) – the solution to the TTP model.plotly</p></li>
<li><p><strong>night_start_time</strong> (<em>astropy time object</em>) – Beginning of observing interval</p></li>
<li><p><strong>extras</strong> (<em>array</em>) – starnames of “extra” stars (those not fit into the script)</p></li>
<li><p><strong>filler_stars</strong> (<em>array</em>) – star names of the stars added in the bonus round</p></li>
<li><p><strong>current_day</strong> (<em>str</em>) – today’s date in format YYYY-MM-DD</p></li>
<li><p><strong>outputdir</strong> (<em>str</em>) – the directory to save the script file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.io.write_stars_schedule_human_readable">
<span class="sig-prename descclassname"><span class="pre">kpfcc.io.</span></span><span class="sig-name descname"><span class="pre">write_stars_schedule_human_readable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combined_semester_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yrds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/io.html#write_stars_schedule_human_readable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.io.write_stars_schedule_human_readable" title="Link to this definition"></a></dt>
<dd><p>Turns the non-square matrix of the solution into a square matrix and starts the human readable
solution by filling in the slots where a star’s exposre is started.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>combined_semester_schedule</strong> (<em>array</em>) – the human readable solution</p></li>
<li><p><strong>Yns</strong> (<em>array</em>) – the Gurobi solution with keys of (starname, slot_number) and values 1 or 0.</p></li>
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
<li><p><strong>round_info</strong> (<em>str</em>) – the solution round, ie “Round1”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated human readable solution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>combined_semester_schedule (array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.management">
<span id="management"></span><h2>Management<a class="headerlink" href="#module-kpfcc.management" title="Link to this heading"></a></h2>
<p>Module defining the admin object, which stores, manipulates, and passes information across
all requests easily.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import admin_functions as af</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.management.build_date_dictionary">
<span class="sig-prename descclassname"><span class="pre">kpfcc.management.</span></span><span class="sig-name descname"><span class="pre">build_date_dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">semester_start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semester_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#build_date_dictionary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.build_date_dictionary" title="Link to this definition"></a></dt>
<dd><p>Builds a dictionary where keys are the calendar dates within the semester and values are the
corresponding day numbers of the semester.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>semester_start_date</strong> (<em>str</em>) – the first day of the semester, format YYYY-MM-DD</p></li>
<li><p><strong>semester_length</strong> (<em>int</em>) – the number of days in the full semester</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.management.compute_slots_required_for_exposure">
<span class="sig-prename descclassname"><span class="pre">kpfcc.management.</span></span><span class="sig-name descname"><span class="pre">compute_slots_required_for_exposure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exposure_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_round_up_flag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#compute_slots_required_for_exposure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.compute_slots_required_for_exposure" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kpfcc.management.data_admin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kpfcc.management.</span></span><span class="sig-name descname"><span class="pre">data_admin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observatory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requests_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_observations_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allocation_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accessibilities_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_map_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_out_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonqueue_map_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonqueue_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_weather_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_optimal_allocation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_aesthetic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_quarters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_represented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_single_quarters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_consecutive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_consecutive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiteout_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blackout_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gurobi_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solve_time_limit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solve_max_gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_round_two</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bonus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_forecasts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_cadences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">turn_on_off_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmap_template_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_forecast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_starmaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nightly_start_stop_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_observability_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#data_admin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.data_admin" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Data Admin object, from which we can easily pass around information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_day</strong> (<em>-</em>) – Sets the “first” day of the semester from which to compute the
semester schedule solution from this day forward. Format: YYYY-MM-DD.</p></li>
<li><p><strong>requests_file</strong> (<em>-</em>) – Confirm that column names are correct.</p></li>
<li><p><strong>allocation_file</strong> (<em>-</em>)</p></li>
<li><p><strong>accessibilities_file</strong> (<em>-</em>) – dictionary of target names and associated pre-computed 1D
accessibility maps of length equal to n_slots_in_semester.</p></li>
<li><p><strong>twilight_file</strong> (<em>-</em>)</p></li>
<li><p><strong>output_directory</strong> (<em>-</em>) – It is recommended that the path be outside the git repo.</p></li>
<li><p><strong>slot_size</strong> (<em>-</em>)</p></li>
<li><p><strong>run_round_two</strong> (<em>-</em>) – When False, do not run the bonus round.</p></li>
<li><p><strong>past_observations_file</strong> (<em>-</em>) – on all previous observations in the semester. If file
does not exist, then we are ignoring prior observations.</p></li>
<li><p><strong>semester_template_file</strong> (<em>-</em>) – template of the semester. For plotting purposes only.</p></li>
<li><p><strong>turn_off_on_file</strong> (<em>-</em>) – first and last day of accessiblity for each target.
For plotting purposes only.</p></li>
<li><p><strong>nonqueue_map_file</strong> (<em>-</em>) – n_nights_in_semester by n_slots_in_night elements where slots
reserved for non-queue observations are filled with target name.</p></li>
<li><p><strong>special_map_file</strong> (<em>-</em>) – n_nights_in_semester by n_slots_in_night elements which contains
information on the custom set of slots a request can be
scheduled into for various reasons of the PI</p></li>
<li><p><strong>zero_out_file</strong> (<em>-</em>) – tonight for any reason. Often this is empty.</p></li>
<li><p><strong>run_weather_loss</strong> (<em>-</em>)</p></li>
<li><p><strong>run_optimal_allocation</strong> (<em>-</em>)</p></li>
<li><p><strong>include_aesthetic</strong> (<em>-</em>)</p></li>
<li><p><strong>max_quarters</strong> (<em>-</em>)</p></li>
<li><p><strong>max_nights</strong> (<em>-</em>)</p></li>
<li><p><strong>whiteout_file</strong> (<em>-</em>)</p></li>
<li><p><strong>blackout_file</strong> (<em>-</em>)</p></li>
<li><p><strong>gurobi_output</strong> (<em>-</em>) – to the terminal as it solves the model.</p></li>
<li><p><strong>plot_results</strong> (<em>-</em>)</p></li>
<li><p><strong>solve_time_limit</strong> (<em>-</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.management.data_admin.build_slots_required_dictionary">
<span class="sig-name descname"><span class="pre">build_slots_required_dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">always_round_up_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#data_admin.build_slots_required_dictionary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.data_admin.build_slots_required_dictionary" title="Link to this definition"></a></dt>
<dd><p>Computes the slots needed for a given exposure for all requests.
When always_round_up_flag is false, we can round up or down.
Example: with 5 minute slot sizes, we want a 6 minute exposure to only require one slot</p>
<blockquote>
<div><p>(round down) as opposed to 2 slots (round up)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
<li><p><strong>always_round_up_flag</strong> (<em>boolean</em>) – if true, slots needed is always larger than exposure_time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.management.data_admin.run_admin">
<span class="sig-name descname"><span class="pre">run_admin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#data_admin.run_admin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.data_admin.run_admin" title="Link to this definition"></a></dt>
<dd><p>Given today’s date, collate all important information about the semester.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.management.get_gap_filler_targets">
<span class="sig-prename descclassname"><span class="pre">kpfcc.management.</span></span><span class="sig-name descname"><span class="pre">get_gap_filler_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#get_gap_filler_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.get_gap_filler_targets" title="Link to this definition"></a></dt>
<dd><p>Using the results of the two rounds of scheduling, determine what is different between them,
i.e. which targets were added in Round 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.management.get_semester_info">
<span class="sig-prename descclassname"><span class="pre">kpfcc.management.</span></span><span class="sig-name descname"><span class="pre">get_semester_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/management.html#get_semester_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.management.get_semester_info" title="Link to this definition"></a></dt>
<dd><p>Given today’s date, return information about the semester we are currently in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.maps">
<span id="maps"></span><h2>Maps<a class="headerlink" href="#module-kpfcc.maps" title="Link to this heading"></a></h2>
<p>Module for working with the various maps</p>
<p>This module organizes and builds the maps used by the semester solver to block out large portions
of time for one of many reasons. Designed to be only run as a function call from
the generateScript.py script.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import mapping_functions as mf</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.build_allocation_map">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">build_allocation_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allocation_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weather_diff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#build_allocation_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.build_allocation_map" title="Link to this definition"></a></dt>
<dd><p>Create the 1D allocation map where allocated slots are designated with a 1
and non-allocated slots designated with a 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocation_schedule</strong> (<em>array</em>) – a 2D array of shape n_nights_in_semester by n_quarters_in_night
elements are 1 if that night/quarter is allocated to the queue
and 0 otherwise</p></li>
<li><p><strong>weather_diff</strong> (<em>array</em>) – same as allocation_schedule but 1 if that night/quarter has been
declared to be weathered out (for plotting/tracking purposes)</p></li>
<li><p><strong>available_slots_in_night</strong> (<em>array</em>) – a 1D array of length n_nights_in_semester where each
element is an integer representing the number of slots within that
night that during night time</p></li>
<li><p><strong>n_slots_in_night</strong> (<em>int</em>) – the number of slots in a single night</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length equal to n_slots_in_semester,</dt><dd><p>1’s are allocated and 0’s are non-allocated slots</p>
</dd>
<dt>allocation_map_2D (array): a 2D array of shape n_nights_in_semester by n_slots_in_night</dt><dd><p>with same information as allocation_map_1D</p>
</dd>
<dt>allocation_map_weather_diff_2D (array): a 2D array of shape n_nights_in_semester by</dt><dd><p>n_slots_in_night where 1’s are nights that were
allocated but weathered out (for plotting purposes)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>allocation_map_1D (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.compute_on_off_for_quarter">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">compute_on_off_for_quarter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quarter_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quarter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#compute_on_off_for_quarter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.compute_on_off_for_quarter" title="Link to this definition"></a></dt>
<dd><p>Determine the first and last day a target is accessible in a given quarter of the night.
Primarily for easy lookup plotting purposes later.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observability_matrix</strong> (<em>array</em>) – a 1D array of length equal to n_slots_in_night representing a
single night where 1 indicates target is accessible in that
slot, 0 otherwise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length n_quarters_in_night where each element</dt><dd><p>represents if the target is at all observerable in that quarter
(1st to 4th running left to right).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>observable_quarters (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.construct_custom_map_dict">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">construct_custom_map_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">special_map_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#construct_custom_map_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.construct_custom_map_dict" title="Link to this definition"></a></dt>
<dd><p>Read in the customize acccessibility maps for unique targets, if exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>special_map_file</strong> (<em>str</em>) – path and filename of the precomputed custom maps</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>keys are the starnames and values are the 1D custom maps</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>custom_access_maps (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.construct_nonqueue_arr">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">construct_nonqueue_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#construct_nonqueue_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.construct_nonqueue_arr" title="Link to this definition"></a></dt>
<dd><p>Build the 1D non-queue map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the 1D array of 1’s and 0’s indicating nonqueue map</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nonqueue_map_file_slots_ints (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.construct_zero_out_arr">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">construct_zero_out_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zero_out_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#construct_zero_out_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.construct_zero_out_arr" title="Link to this definition"></a></dt>
<dd><p>Read in the list of targets to “zero out”, i.e. not allowed to be scheduled only tonight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>zero_out_file</strong> (<em>str</em>) – path and filename of the stars to be zeroed out</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of stars to be zeroed out</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>zero_out_names (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.convert_allocation_array_to_binary">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">convert_allocation_array_to_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#convert_allocation_array_to_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.convert_allocation_array_to_binary" title="Link to this definition"></a></dt>
<dd><p>Used in optimal allocation, write out the results of the calendar to human readable format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocation_map_2D</strong> (<em>array</em>) – a 2D array of length n_nights_in_semester by n_quarters_in_night,
[Q1, Q2, Q3, Q4] where binary elements indicate allocation.</p></li>
<li><p><strong>all_dates_array</strong> (<em>dict</em>) – the calendar dates of the semester</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – the path and filename to save the outputted file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.convert_utc_to_hst">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">convert_utc_to_hst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestring</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#convert_utc_to_hst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.convert_utc_to_hst" title="Link to this definition"></a></dt>
<dd><p>Convert between the UTC time and the HST time. Note Hawaii does not change clocks with
daylight savings so this is always a straight-forward transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestring</strong> (<em>str</em>) – timestamp in question, format HH:MM</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of the slots in minutes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the time, in HH:MM format, of the start of the nearest slot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output_time (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.format_keck_allocation_info">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">format_keck_allocation_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocation_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#format_keck_allocation_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.format_keck_allocation_info" title="Link to this definition"></a></dt>
<dd><p>Read in allocation file, as downloaded from this site, filter by KPF and the relevant semester:
<a class="reference external" href="https://www2.keck.hawaii.edu/observing/keckSchedule/queryForm.php">https://www2.keck.hawaii.edu/observing/keckSchedule/queryForm.php</a></p>
<p>Thanks to H. Isaacson for portion of code which I adapted further.
Here we are parsing the Time column for which quarters of the night are allocated to us.
Note: this assumes time is awarded in 0.25 night increments.
If non-0.25 increment of time exists, assume the whole night is allocated and then</p>
<blockquote>
<div><p>the best way to deal with this is to later define a new map,
set the relevant slots equal to 0, then apply map to all targets.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocation_file</strong> (<em>str</em>) – the path and filename to the downloaded csv</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dataframe containing each night’s award and start/stop times</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>allocation (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.prepare_allocation_map">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">prepare_allocation_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#prepare_allocation_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.prepare_allocation_map" title="Link to this definition"></a></dt>
<dd><p>When not in optimal allocation mode, prepare and construct the allocation map, as well as
perform the weather loss modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocation_file</strong> (<em>str</em>) – the path and filename to the binary map of allocated quarters/nights</p></li>
<li><p><strong>current_day</strong> (<em>str</em>) – today’s date, format YYYY-MM-DD</p></li>
<li><p><strong>semester_length</strong> (<em>int</em>) – the number of days in a full semester</p></li>
<li><p><strong>DATADIR</strong> (<em>str</em>) – the path to the pre-computed data files</p></li>
<li><p><strong>all_dates_array</strong> (<em>array</em>) – the list of calendar dates in the semester</p></li>
<li><p><strong>run_weather_loss</strong> (<em>boolean</em>) – If True, run the weather loss model. If False, no weather loss.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – the path to which to save</p></li>
<li><p><strong>available_slots_in_night</strong> (<em>array</em>) – a 1D array of length n_nights_in_semester where each
element is an integer representing the number of slots within that
night that during night time</p></li>
<li><p><strong>today_starting_night</strong> (<em>int</em>) – the day number of today’s date in the semester</p></li>
<li><p><strong>n_slots_in_night</strong> (<em>int</em>) – the number of slots in a single night</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>1D array for remainder of semester where elements are 1 if</dt><dd><p>the night was allocated, but modelled as a weather loss</p>
</dd>
<dt>allocation_map_1D (array): a 1D array of length equal to n_slots_in_semester,</dt><dd><p>1’s are allocated and 0’s are non-allocated slots</p>
</dd>
<dt>allocation_map_2D (array): a 2D array of shape n_nights_in_semester by n_slots_in_night</dt><dd><p>with same information as allocation_map_1D</p>
</dd>
<dt>weathered_map (array): a 2D array of shape n_nights_in_semester by</dt><dd><p>n_slots_in_night where 1’s are nights that were
allocated but weathered out (for plotting purposes)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>weather_diff_remaining (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.produce_ultimate_map">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">produce_ultimate_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allocation_map_1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twilight_map_remaining_flat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#produce_ultimate_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.produce_ultimate_map" title="Link to this definition"></a></dt>
<dd><p>Combine all maps for a target to produce the final map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requests_frame</strong> (<em>dataframe</em>) – the pandas dataframe containing request information</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>keys are the starnames and values are the 1D array</dt><dd><p>of the final map</p>
</dd>
<dt>available_indices_for_request (dictionary): keys are the starnames and values are a 1D array</dt><dd><p>the indices where available_slots_for_request is 1.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>available_slots_for_request (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.quarter_translator">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">quarter_translator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#quarter_translator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.quarter_translator" title="Link to this definition"></a></dt>
<dd><p>Map the start/stop fractions to binary map.
I can’t think of a better/automated way to do this other than brute force, sorry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>float</em>) – the fraction of night where the night begins</p></li>
<li><p><strong>stop</strong> (<em>float</em>) – the fraction of night where the night ends</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a string representation of the quarters of the night that are allocated</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>night_map (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.quarters_observable">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">quarters_observable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observability_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#quarters_observable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.quarters_observable" title="Link to this definition"></a></dt>
<dd><p>For a single night, using the full night’s slots accessibility map,
determine which of the quarters the given target is observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>observability_matrix</strong> (<em>array</em>) – a 1D array of length equal to n_slots_in_night representing a
single night where 1 indicates target is accessible in that
slot, 0 otherwise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 1D array of length n_quarters_in_night where each element</dt><dd><p>represents if the target is at all observerable in that quarter
(1st to 4th running left to right).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>observable_quarters (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.maps.round_time_to_slot">
<span class="sig-prename descclassname"><span class="pre">kpfcc.maps.</span></span><span class="sig-name descname"><span class="pre">round_time_to_slot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/maps.html#round_time_to_slot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.maps.round_time_to_slot" title="Link to this definition"></a></dt>
<dd><p>From a given timestamp, determine the timestamp of the nearest slot’s start.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_time</strong> (<em>int</em>) – timestamp in question, format HH:MM</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of the slots in minutes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the time, in HH:MM format, of the start of the nearest slot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output_time (array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.onsky">
<span id="onsky"></span><h2>Onsky<a class="headerlink" href="#module-kpfcc.onsky" title="Link to this heading"></a></h2>
<p>Module for running the TTP.
Designed to be only run as a function call from the generateScript.py script.</p>
<p>See <a class="reference external" href="https://github.com/lukehandley/ttp/tree/main">https://github.com/lukehandley/ttp/tree/main</a> for more info about the TTP</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import ttp_functions as ttp</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.onsky.prepare_for_ttp">
<span class="sig-prename descclassname"><span class="pre">kpfcc.onsky.</span></span><span class="sig-name descname"><span class="pre">prepare_for_ttp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">night_plan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_two_targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/onsky.html#prepare_for_ttp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.onsky.prepare_for_ttp" title="Link to this definition"></a></dt>
<dd><p>Prepare tonight’s scheduled stars for their run through the TTP (separate software package)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request_sheet</strong> (<em>dataframe</em>) – the csv of PI requests</p></li>
<li><p><strong>night_plan</strong> (<em>array</em>) – the n’th row of combined_semester_schedule array</p></li>
<li><p><strong>round_two_targets</strong> (<em>array</em>) – a 1D list of the stars that were added in the bonus round</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the data on the stars to be observed tonight, formatted in the way that</dt><dd><p>the TTP software requires as an input</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>to_ttp (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.onsky.produce_bright_backups">
<span class="sig-prename descclassname"><span class="pre">kpfcc.onsky.</span></span><span class="sig-name descname"><span class="pre">produce_bright_backups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backup_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_observability_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observatory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_start_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_stop_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/onsky.html#produce_bright_backups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.onsky.produce_bright_backups" title="Link to this definition"></a></dt>
<dd><p>Produce the TTP solution given the results of the autoscheduler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backup_file</strong> (<em>str</em>)</p></li>
<li><p><strong>backup_observability_file</strong> (<em>str</em>) – hours each night each backup star is observable for</p></li>
<li><p><strong>observation_start_time</strong> (<em>str</em>) – MM</p></li>
<li><p><strong>observation_stop_time</strong> (<em>str</em>) – MM</p></li>
<li><p><strong>current_day</strong> (<em>str</em>)</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.onsky.run_ttp">
<span class="sig-prename descclassname"><span class="pre">kpfcc.onsky.</span></span><span class="sig-name descname"><span class="pre">run_ttp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/onsky.html#run_ttp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.onsky.run_ttp" title="Link to this definition"></a></dt>
<dd><p>Produce the TTP solution given the results of the autoscheduler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schedule_file</strong> (<em>str</em>)</p></li>
<li><p><strong>nightly_start_stop_times_file</strong> (<em>str</em>)</p></li>
<li><p><strong>request_sheet</strong> (<em>str</em>)</p></li>
<li><p><strong>current_day</strong> (<em>str</em>)</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.plot">
<span id="plot"></span><h2>Plot<a class="headerlink" href="#module-kpfcc.plot" title="Link to this heading"></a></h2>
<p>Module for plotting.
Designed to be only run as a function call from the generateScript.py script.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import plotting_functions as ptf</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.build_multi_request_cof">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">build_multi_request_cof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_cofs_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_first_forecasts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_burn_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#build_multi_request_cof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.build_multi_request_cof" title="Link to this definition"></a></dt>
<dd><p>Build the COF plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>all_cofs_array</strong> (<em>array</em>) – an array of COF arrays</p></li>
<li><p><strong>star_info</strong> (<em>dict</em>) – keys are the star names, values are</p></li>
<li><p><strong>all_first_forecasts</strong> (<em>array</em>) – array of the first forecast arrays for each star in set</p></li>
<li><p><strong>even_burn_rate</strong> (<em>boolean</em>) – if True, show an even burn rate line</p></li>
<li><p><strong>flag</strong> (<em>boolean</em>) – if True, the plot is only for the admin view</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.create_single_program_birds_eye">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">create_single_program_birds_eye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#create_single_program_birds_eye"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.create_single_program_birds_eye" title="Link to this definition"></a></dt>
<dd><p>Prepare data for a birds eye view plot of one program’s requests</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>program</strong> (<em>str</em>) – the program code</p></li>
<li><p><strong>color</strong> (<em>object</em>) – seaborn color palette value for this program</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>all of the starmaps of requests in the program
all_star_cols (array): the colors to plot each request on the birds eye
all_star_nobs (array): the number of observations in each scheduled window
stars_in_program (array): the list of the stars within the program</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>all_star_maps (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.generate_admin_view_plot_suite">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">generate_admin_view_plot_suite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_of_program_cofs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_program_first_forecasts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_star_maps_all_programs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_star_colors_all_programs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_star_nobs_all_programs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_stars_in_program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prog_colors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#generate_admin_view_plot_suite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.generate_admin_view_plot_suite" title="Link to this definition"></a></dt>
<dd><p>Construct all plots for admin view</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>set_of_program_cofs</strong> (<em>array</em>) – each element is an array containing the cof of a program</p></li>
<li><p><strong>program_info</strong> (<em>dict</em>) – keys are program codes and values are total obs for program</p></li>
<li><p><strong>all_program_first_forecasts</strong> (<em>array</em>) – each element is an array containing the first forecast
for the program, cof.</p></li>
<li><p><strong>all_star_maps_all_programs</strong> (<em>array</em>) – all of the programmatic running total percentages</p></li>
<li><p><strong>all_star_colors_all_programs</strong> (<em>array</em>) – the colors to plot each program on the birds eye</p></li>
<li><p><strong>all_star_nobs_all_programs</strong> (<em>array</em>) – the number of observations in each scheduled window</p></li>
<li><p><strong>all_stars_in_program</strong> (<em>array</em>) – the list of the stars within the program</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.generate_birds_eye">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">generate_birds_eye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_star_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_star_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_star_nobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars_in_program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonqueue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#generate_birds_eye"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.generate_birds_eye" title="Link to this definition"></a></dt>
<dd><p>Plot a birds eye view of one program’s requests</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>all_star_maps</strong> (<em>array</em>) – all of the starmaps of requests in the program</p></li>
<li><p><strong>all_star_cols</strong> (<em>array</em>) – the colors to plot each request on the birds eye</p></li>
<li><p><strong>all_star_nobs</strong> (<em>array</em>) – the number of observations in each scheduled window</p></li>
<li><p><strong>program</strong> (<em>str</em>) – the program code</p></li>
<li><p><strong>stars_in_program</strong> (<em>array</em>) – the list of the stars within the program</p></li>
<li><p><strong>nonqueue</strong> (<em>boolean</em>) – if True, plot the non-queue times on the birds eye view</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.generate_cadence_view_plot">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">generate_cadence_view_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#generate_cadence_view_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.generate_cadence_view_plot" title="Link to this definition"></a></dt>
<dd><p>Build cadence overview plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>program</strong> (<em>str</em>) – the program code</p></li>
<li><p><strong>starname</strong> (<em>str</em>) – the name of the star in question</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.generate_single_program_plot_suite">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">generate_single_program_plot_suite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_cadence_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#generate_single_program_plot_suite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.generate_single_program_plot_suite" title="Link to this definition"></a></dt>
<dd><p>Plot the birds eye view for the single program PI view</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>program_code</strong> (<em>str</em>) – the program code</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the calculated cof array for each star in program
total_program_requested_nobs (int): the total requested observations within the program
program_first_forecast (array): the first forecast for each star in program</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>program_cof_percent (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.process_single_target_for_birds_eye">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">process_single_target_for_birds_eye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#process_single_target_for_birds_eye"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.process_single_target_for_birds_eye" title="Link to this definition"></a></dt>
<dd><p>Collect the data for a birds eye view plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>starname</strong> (<em>str</em>) – the name of the star in question</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>n_nights_in_semester by n_slots_in_night, 1 when target is scheduled
nobs (int): the sum of all future observations</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>starmap (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.programmatic_cof">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">programmatic_cof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_of_request_cofs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_program_observations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#programmatic_cof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.programmatic_cof" title="Link to this definition"></a></dt>
<dd><p>Build the cumulative obesrvation function for a group of requests</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>list_of_request_cofs</strong> (<em>array</em>) – an array of COF arrays</p></li>
<li><p><strong>total_program_observations</strong> (<em>int</em>) – sum of all exposures for the set of requests</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>of length semester_length, the running number of</dt><dd><p>observations over the course of the semester</p>
</dd>
<dt>program_cof_percent (array): of length semester_length, the running percent of</dt><dd><p>request completion over the course of the semester</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>program_cof_counter (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.run_plot_suite">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">run_plot_suite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#run_plot_suite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.run_plot_suite" title="Link to this definition"></a></dt>
<dd><p>A one line call to kick off all the plotting/reporting routines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>outputdir</strong> (<em>str</em>) – directory to save outputs</p></li>
<li><p><strong>build_starmaps</strong> (<em>boolean</em>) – if true, spend the time to build the star maps</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.single_request_cof">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">single_request_cof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#single_request_cof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.single_request_cof" title="Link to this definition"></a></dt>
<dd><p>Compute cumulative observation function for a single request</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_tracker</strong> (<em>object</em>) – a object from the StarTracker class</p></li>
<li><p><strong>star</strong> (<em>str</em>) – the name of the star in question</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>of length semester_length, the running number of</dt><dd><p>observations over the course of the semester</p>
</dd>
<dt>running_total_obs_percent (array): of length semester_length, the running percent of</dt><dd><p>request completion over the course of the semester</p>
</dd>
</dl>
<p>total_observations_requested (int): the number of exposure to complete the request
first_forecast (dataframe): contains information on the first forecast of the target</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>running_total_obs_counter (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.write_cadence_plot_files">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">write_cadence_plot_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#write_cadence_plot_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.write_cadence_plot_files" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.plot.write_one_cadence_plot_file">
<span class="sig-prename descclassname"><span class="pre">kpfcc.plot.</span></span><span class="sig-name descname"><span class="pre">write_one_cadence_plot_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">turn_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requests_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_hst_dates_observed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/plot.html#write_one_cadence_plot_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.plot.write_one_cadence_plot_file" title="Link to this definition"></a></dt>
<dd><p>Write the file from which later we can produce the cadence plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starname</strong> (<em>int</em>) – the string of the star’s name</p></li>
<li><p><strong>starmap</strong> (<em>dataframe</em>) – contains information on observation history and forecast</p></li>
<li><p><strong>turn_frame</strong> (<em>dataframe</em>) – contains information on the first and last day a target
is observable in each quarter of the night. Pre-computed.</p></li>
<li><p><strong>requests_frame</strong> (<em>dataframe</em>) – the information on the request strategies</p></li>
<li><p><strong>unique_hst_dates_observed</strong> (<em>array</em>) – list of dates previously observed</p></li>
<li><p><strong>current_day</strong> (<em>str</em>) – today’s date, format YYYY-MM-DD</p></li>
<li><p><strong>outputdir</strong> (<em>str</em>) – the path to the save directory</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.schedule">
<span id="schedule"></span><h2>Schedule<a class="headerlink" href="#module-kpfcc.schedule" title="Link to this heading"></a></h2>
<p>Module for running the semester solver.</p>
<p>This module organizes, builds, and solves the gurobi model. It also writes and organizes the
outputs of the schedule into both machine human readable forms. It is designed to produce info
that is in correct formatting for running the TTP. Further designed to be only run as a function
call from the generateScript.py script.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import solve_semester as ssm</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.schedule.run_kpfcc">
<span class="sig-prename descclassname"><span class="pre">kpfcc.schedule.</span></span><span class="sig-name descname"><span class="pre">run_kpfcc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/schedule.html#run_kpfcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.schedule.run_kpfcc" title="Link to this definition"></a></dt>
<dd><p>Run the core kpfcc algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object that has already run the function “run_admin()”</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc.tracking">
<span id="tracking"></span><h2>Tracking<a class="headerlink" href="#module-kpfcc.tracking" title="Link to this heading"></a></h2>
<p>Module for plotting.
Designed to be only run as a function call from the generateScript.py script.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import plotting_functions as ptf</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kpfcc.tracking.</span></span><span class="sig-name descname"><span class="pre">StarTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An object to easily pass around compute and pass around information on the past/future scheduling of stars.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker.create_folders">
<span class="sig-name descname"><span class="pre">create_folders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">main_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">styles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker.create_folders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker.create_folders" title="Link to this definition"></a></dt>
<dd><p>Check if folders exist, if not, create them</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_path</strong> (<em>str</em>) – primary root path to save to</p></li>
<li><p><strong>account_types</strong> (<em>str</em>) – the user acount types (admin, PI, etc)</p></li>
<li><p><strong>dates</strong> (<em>str</em>) – the dates in question</p></li>
<li><p><strong>styles</strong> (<em>str</em>) – the names of the plots to be generated, store them separately</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker.get_star_first_forecast">
<span class="sig-name descname"><span class="pre">get_star_first_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker.get_star_first_forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker.get_star_first_forecast" title="Link to this definition"></a></dt>
<dd><p>Retrieve the information for later comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>program</strong> (<em>str</em>) – the program code</p></li>
<li><p><strong>name</strong> (<em>str</em>) – the name of the star in question</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>contains information on the first forecast of the target</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>first_forecast (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker.get_star_forecast">
<span class="sig-name descname"><span class="pre">get_star_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker.get_star_forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker.get_star_forecast" title="Link to this definition"></a></dt>
<dd><p>Gather the information about a star’s future forecast this semester</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>starname</strong> (<em>str</em>) – the name of the star in question</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a dictionary where keys are the dates of an observation and</dt><dd><p>the values are number of observations to be taken that night</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>observations_future (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker.get_star_past">
<span class="sig-name descname"><span class="pre">get_star_past</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker.get_star_past"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker.get_star_past" title="Link to this definition"></a></dt>
<dd><p>Gather the information about a star’s past observation history this semester</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>starname</strong> (<em>str</em>) – the name of the star in question</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a dictionary where keys are the dates of an observation</dt><dd><p>and the values are number of observations taken on that night</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>observations_past (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker.get_star_stats">
<span class="sig-name descname"><span class="pre">get_star_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker.get_star_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker.get_star_stats" title="Link to this definition"></a></dt>
<dd><p>Grab the observational stategy information for a given star</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>starname</strong> (<em>str</em>) – the name of the star in question</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>how many exposures we expect to take
total_observations_requested (int): sum of observational strategie values
exposure_time (int): exposure time of single shot
slots_per_night (int): number of slots required to complete all exposures in a night
program (str): the program code</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>expected_nobs_per_night (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kpfcc.tracking.StarTracker.write_star_first_forecast">
<span class="sig-name descname"><span class="pre">write_star_first_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">program</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/tracking.html#StarTracker.write_star_first_forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.tracking.StarTracker.write_star_first_forecast" title="Link to this definition"></a></dt>
<dd><p>After the first time running a forecast, record the information for later comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>program</strong> (<em>str</em>) – the program code</p></li>
<li><p><strong>starname</strong> (<em>str</em>) – the name of the star in question</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kpfcc.weather">
<span id="weather"></span><h2>Weather<a class="headerlink" href="#module-kpfcc.weather" title="Link to this heading"></a></h2>
<p>Module defining functions to perform weather loss simulations</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>import weather as wh</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.compute_hours_observable_tonight">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">compute_hours_observable_tonight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#compute_hours_observable_tonight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.compute_hours_observable_tonight" title="Link to this definition"></a></dt>
<dd><p>Determine how many hours a star is up on a given date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> (<em>str</em>) – the calendar date to compute accessibilty in format ‘YYYY-MM-DD’</p></li>
<li><p><strong>target</strong> (<em>str</em>) – an astroplan FixedTarget object</p></li>
<li><p><strong>slot_size</strong> (<em>int</em>) – the size of the slots in minutes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the number of hours the star is observable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>n_hours_observable (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.compute_yearly_accessibility">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">compute_yearly_accessibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#compute_yearly_accessibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.compute_yearly_accessibility" title="Link to this definition"></a></dt>
<dd><p>Pre-compute how many hours a star is up each night of the year</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>contains information on each star’s number of hours</dt><dd><p>accessible on each night</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>backup_observability_frame (dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.get_loss_stats">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">get_loss_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#get_loss_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.get_loss_stats" title="Link to this definition"></a></dt>
<dd><p>Simulate nights totally lost to weather usine historical data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>each element is the percent of total loss for nights,</dt><dd><p>starting with tomorrow and going to end of semester</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss_stats_remaining (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.get_stars_for_tonight">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">get_stars_for_tonight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_up_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#get_stars_for_tonight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.get_stars_for_tonight" title="Link to this definition"></a></dt>
<dd><p>Get a list of stars for backup tonight</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>manager</strong> (<em>obj</em>) – a data_admin object</p></li>
<li><p><strong>minimum_up_time</strong> (<em>int</em>) – minimum number of hours accessible to be considered observable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>contains the names of the stars that are observable tonight</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>starlist (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.get_times_worth">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">get_times_worth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backup_list_tonight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hours_needed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#get_times_worth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.get_times_worth" title="Link to this definition"></a></dt>
<dd><p>Get a list of stars for backup tonight that fills a given amount of hours worth of time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backup_list_tonight</strong> (<em>array</em>) – contains the stars from the wider backup pool selected as
observable for tonight</p></li>
<li><p><strong>n_hours_needed</strong> (<em>int</em>) – the number of hours of open shutter time to fill</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>contains the subset of stars from the wider backup pool</dt><dd><p>selected as  observable for tonight</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>selected_stars_frame (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.simulate_weather_losses">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">simulate_weather_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocation_remaining</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_lose_nights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#simulate_weather_losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.simulate_weather_losses" title="Link to this definition"></a></dt>
<dd><p>Simulate nights totally lost to weather usine historical data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocation_remaining</strong> (<em>array</em>) – a 1D array of length n_nights_in_semester where 1’s represent
allocated night and 0’s represent non-allocated night</p></li>
<li><p><strong>loss_stats</strong> (<em>array</em>) – 1D array of length n_nights_in_semester where elements are the
percent of the time that night is totally lost to weather</p></li>
<li><p><strong>covariance</strong> (<em>float</em>) – the added percent that tomorrow will be lost if today is lost</p></li>
<li><p><strong>dont_lose_nights</strong> (<em>boolean</em>) – a flag that turns off weather simulation entirely</p></li>
<li><p><strong>plot</strong> (<em>boolean</em>) – a flag to visualize the allocation and weather loss</p></li>
<li><p><strong>outputdir</strong> (<em>str</em>) – path to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1’s represent the night still is allocated
weather_diff_remaining_2D (array): 1’s represent the night still weathered
weather_diff_remaining_1D (array): 1’s represent the night still weathered</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>allocation_remaining_post_losses (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kpfcc.weather.write_out_weather_stats">
<span class="sig-prename descclassname"><span class="pre">kpfcc.weather.</span></span><span class="sig-name descname"><span class="pre">write_out_weather_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days_lost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allocation_remaining</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kpfcc/weather.html#write_out_weather_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kpfcc.weather.write_out_weather_stats" title="Link to this definition"></a></dt>
<dd><p>Write out data on the results of the weather simulation. For comparing acrossing MCMC simulations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_dates_dict</strong> (<em>dict</em>) – keys are the dates of the semester, values are the day number of semester</p></li>
<li><p><strong>current_day</strong> (<em>star</em>) – today’s date in format YYYY-MM-DD</p></li>
<li><p><strong>days_lost</strong> (<em>array</em>) – a binary 1D array designating if the night was lost. Note that the length
of this array is n_nights_in_semester-1 which is smaller than len(all_dates_dict)</p></li>
<li><p><strong>allocation_remaining</strong> (<em>array</em>) – a binary 2D array of dates by quarters where 1 indicates
quarter allocated and 0 not. Note that the length
of this array is n_nights_in_semester-1 which is smaller
than len(all_dates_dict)</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – path to save the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kpfcc">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-kpfcc" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to AstroQ_docs’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jack Lubin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>